<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contenido - El Cuaderno de √Åfrica</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Mouse+Memoirs&display=swap');
    </style>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" href="assets/img/pencil.png" type="image/x-icon">
    <style>
        .content-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            margin: 2rem auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-family: var(--font-display);
            font-size: 2.5rem;
            color: #FF6B6B;
            text-align: center;
            margin-bottom: 2rem;
        }

        .exercise-card {
            background: #f9f9f9;
            border-left: 5px solid #4ECDC4;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 10px;
        }

        .summary-card {
            background: #fff8f0;
            border-left: 5px solid #FF6B6B;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 10px;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .btn-option {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 2px solid #ccc;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            font-family: var(--font-main);
            font-size: 1rem;
            text-align: left;
            transition: all 0.3s;
        }

        .btn-option:hover {
            background: #f0f0f0;
            border-color: #aaa;
        }

        .btn-option.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .btn-option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
    </style>
</head>


<body>
    <a href="index.html" class="home-btn" title="Ir al Inicio">üè†</a>

    <header>
        <div id="date-display" class="header-info date"></div>
        <h1 style="cursor: pointer;" onclick="goBack()">Tema 4 üåü</h1>
        <div id="time-display" class="header-info time"></div>
    </header>

    <main>
        <div class="content-container">
            <h2 id="content-mode-title" class="section-title">Cargando...</h2>

            <div id="content-area">
                <!-- El contenido se inyectar√° aqu√≠ din√°micamente -->
                <p style="text-align: center; color: #888;">Selecciona una actividad para empezar.</p>
            </div>

            <div style="margin-top: 2rem; text-align: center;">
                <button onclick="goBack()" style="
                    border: none;
                    cursor: pointer;
                    display: inline-block;
                    padding: 1rem 2rem;
                    background: #FF6B6B;
                    color: white;
                    text-decoration: none;
                    font-family: var(--font-display);
                    font-size: 1.5rem;
                    border-radius: 50px;
                    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
                    transition: transform 0.2s;
                " onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
                    ‚¨ÖÔ∏è Volver
                </button>
            </div>
        </div>
    </main>

    <footer>
        <p>Hecho con ‚ù§Ô∏è para la mejor estudiante</p>
    </footer>

    <script src="assets/js/clock.js"></script>
    <script>
        function goBack() {
            const params = new URLSearchParams(window.location.search);
            const type = params.get('type') || 'ejercicios';
            const asignatura = params.get('asignatura') || 'castellano';
            const tema = params.get('tema');
            const subseccion = params.get('subseccion');

            // Si estamos en una subsecci√≥n (dentro de una ficha y NO es math), volvemos al men√∫ del tema
            // Para Mates, siempre volvemos a temas.html
            if (asignatura === 'mates') {
                window.location.href = `temas.html?asignatura=${asignatura}&type=${type}`;
                return;
            }

            if (subseccion) {
                window.location.href = `contenido.html?asignatura=${asignatura}&tema=${tema}&type=${type}`;
            } else {
                window.location.href = `temas.html?asignatura=${asignatura}&type=${type}`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            try {
                const params = new URLSearchParams(window.location.search);
                const asignatura = params.get('asignatura');
                const type = params.get('type');
                const subseccion = params.get('subseccion');
                const tema = params.get('tema'); // Puede ser undefined

                const modeTitle = document.getElementById('content-mode-title');
                const contentArea = document.getElementById('content-area');

                // ROUTING SYSTEM
                // 1. Mates (Calculadora / Batch)
                if (asignatura === 'mates') {
                    modeTitle.textContent = "Matem√°ticas - Sumo y Resto (Llev√°ndome) üßÆ";
                    document.title = "Sumo y Resto - Matem√°ticas";
                    renderMath(contentArea);

                    // 2. Valenci√†
                } else if (asignatura === 'valencia' || asignatura === 'valenci√†') {  // Handle alias if any
                    if (type === 'resumenes') {
                        renderValenciaResumenes(contentArea, modeTitle, tema);
                    } else {
                        renderValenciaEjercicios(contentArea, modeTitle, tema, subseccion, params);
                    }

                    // 3. Ingl√©s
                } else if (asignatura === 'ingles' || asignatura === 'english') {
                    if (type === 'resumenes') {
                        renderInglesResumenes(contentArea, modeTitle, tema);
                    } else {
                        renderInglesEjercicios(contentArea, modeTitle, tema);
                    }

                    // 4. Lengua Castellana
                } else if (asignatura === 'castellano' || asignatura === 'lengua') {
                    if (type === 'resumenes') {
                        renderLenguaResumenes(contentArea, modeTitle); // Default Theme 4
                    } else {
                        renderLenguaEjercicios(contentArea, modeTitle, subseccion, params);
                    }

                    // 5. Default / Work In Progress (Medi, Religion, etc.)
                } else {
                    renderWorkInProgress(contentArea, modeTitle, asignatura);
                }

                // --- HELPER FUNCTIONS ---

                function renderMath(container) {
                    container.innerHTML = `
                    <div id="math-container" style="text-align: center;">
                        <div class="summary-card" style="background: #E3F2FD; margin-bottom: 2rem;">
                            <h3>üßÆ ¬°A calcular!</h3>
                            <p>Resuelve las 20 operaciones y luego pulsa el bot√≥n de comprobar. üèÅ</p>
                        </div>
                        <div id="math-grid" style="
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 2rem;
                            width: 100%;
                            max-width: 1000px;
                            margin: 0 auto;
                        ">
                        </div>
                        <div style="margin-top: 3rem; text-align: center;">
                            <button onclick="checkMathBatch()" style="
                                background: #4ECDC4; color: white; border: none; padding: 1rem 4rem; font-size: 1.8rem; 
                                border-radius: 50px; font-family: var(--font-display); cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                                transition: transform 0.2s;
                            " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                ‚úÖ Comprovar Tot!
                            </button>
                        </div>
                        <div id="final-score" style="margin-top: 2rem; font-size: 2rem; font-weight: bold; color: #333;"></div>
                    </div>
                 `;
                    // Init existing math logic if available globally, otherwise define it.
                    // Assuming generateMathOperation is defined in a separate script or we need to add it here.
                    // WAIT: I saw generateMathOperation call in step 886. But NO DEFINITION.
                    // It must be in the previous versions of the file.
                    // I MUST INCLUDE generateMathOperation logic here if it was inline!
                    if (typeof generateMathOperation === 'function') {
                        generateMathOperation();
                    } else {
                        // Define Math Logic Here if missing
                        initMathLogic();
                    }
                }

                function renderWorkInProgress(container, titleElement, subject) {
                    titleElement.textContent = "¬°En Construcci√≥n! üöß";
                    document.title = "En Construcci√≥n";
                    container.innerHTML = `
                         <div style="text-align: center; padding: 3rem;">
                            <div style="font-size: 5rem; margin-bottom: 2rem;">üë∑‚Äç‚ôÄÔ∏èüèóÔ∏è</div>
                            <h3>¬°Estamos trabajando en ${subject ? subject.toUpperCase() : 'esta asignatura'}!</h3>
                            <p>Pronto tendr√°s ejercicios y res√∫menes aqu√≠.</p>
                            <p style="margin-top: 2rem; color: #888;">Mientras tanto, prueba con Mates, Valenci√† o Lengua.</p>
                         </div>
                    `;
                }

                function renderInglesEjercicios(container, titleElement, tema) {
                    titleElement.textContent = "Unit 3 Exercises üá¨üáß";
                    document.title = "Exercises - Unit 3";
                    container.innerHTML = `
                     <div id="exercise-list">
                        <!-- True or False Section -->
                        <div class="exercise-card">
                            <h3>1. Read and circle Yes or No</h3>
                            
                            <div class="true-false-item" style="margin-bottom: 1rem;">
                                <p>üê¢ <strong>The turtle is fast.</strong></p>
                                <button class="btn-option" style="display:inline-block; width:45%;" onclick="selectOption(this, false)">Yes</button>
                                <button class="btn-option" style="display:inline-block; width:45%;" onclick="selectOption(this, true)">No</button>
                            </div>

                            <div class="true-false-item" style="margin-bottom: 1rem;">
                                <p>üêò <strong>The elephant is small.</strong></p>
                                <button class="btn-option" style="display:inline-block; width:45%;" onclick="selectOption(this, false)">Yes</button>
                                <button class="btn-option" style="display:inline-block; width:45%;" onclick="selectOption(this, true)">No</button>
                            </div>

                            <div class="true-false-item" style="margin-bottom: 1rem;">
                                <p>ü¶í <strong>The giraffe is tall.</strong></p>
                                <button class="btn-option" style="display:inline-block; width:45%;" onclick="selectOption(this, true)">Yes</button>
                                <button class="btn-option" style="display:inline-block; width:45%;" onclick="selectOption(this, false)">No</button>
                            </div>
                        </div>

                         <!-- Grammar Section -->
                        <div class="exercise-card">
                            <h3>3. Has got / Hasn't got</h3>
                            <p>Check the correct option.</p>
                            
                            <div style="margin-top: 1rem; border-bottom: 1px solid #ccc; padding-bottom: 1rem;">
                                <p>ü¶í <strong>Giraffe</strong></p>
                                <p>It ______ long neck.</p>
                                <button class="btn-option" onclick="selectOption(this, true)">has got ‚úîÔ∏è</button>
                                <button class="btn-option" onclick="selectOption(this, false)">hasn't got ‚ùå</button>
                            </div>

                            <div style="margin-top: 1rem; border-bottom: 1px solid #ccc; padding-bottom: 1rem;">
                                <p>üêä <strong>Crocodile</strong></p>
                                <p>It ______ small ears.</p>
                                <button class="btn-option" onclick="selectOption(this, false)">has got ‚úîÔ∏è</button>
                                <button class="btn-option" onclick="selectOption(this, true)">hasn't got ‚ùå (No ears visible!)</button>
                            </div>
                        </div>

                        <div style="margin-top: 2rem; text-align: center;">
                            <button onclick="calculateScore()" style="
                            background: #4ECDC4; color: white; border: none; padding: 1rem 3rem; font-size: 1.5rem; 
                            border-radius: 50px; font-family: var(--font-display); cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
                        ">Check Answers! ‚úÖ</button>
                            <div id="score-result" style="display:none; margin-top: 1rem; font-size: 1.5rem; font-weight: bold; color: #FF6B6B;"></div>
                        </div>
                     </div>`;
                }

                function renderInglesResumenes(container, titleElement, tema) {
                    titleElement.textContent = "Summary Unit 3 üá¨üáß";
                    document.title = "Summary - Unit 3";
                    container.innerHTML = `
                    <div class="summary-card">
                        <h3>ü¶Å Wild Animals Vocabulary</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <p>üêí Monkey (Mono)</p>
                            <p>ü¶Å Lion (Le√≥n)</p>
                            <p>ü¶ì Zebra (Cebra)</p>
                            <p>ü¶í Giraffe (Jirafa)</p>
                        </div>
                    </div>
                    
                    <div class="summary-card">
                        <h3>üìè Adjectives (Adjetivos)</h3>
                         <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <p><strong>Big</strong> (Grande) üêò</p>
                            <p><strong>Small</strong> (Peque√±o) üê≠</p>
                            <p><strong>Fast</strong> (R√°pido) üêÜ</p>
                            <p><strong>Slow</strong> (Lento) üê¢</p>
                        </div>
                    </div>

                    <div class="summary-card">
                        <h3>üìù Grammar: Has got / Hasn't got</h3>
                        <p>Usamos <strong>"Has got"</strong> para decir lo que un animal TIENE.</p>
                        <p>Usamos <strong>"Hasn't got"</strong> para decir lo que un animal NO TIENE.</p>
                    </div>`;
                }

                function renderLenguaResumenes(container, titleElement) {
                    titleElement.textContent = "Resumen del Tema 4 üìö";
                    document.title = "Resumen Tema 4";

                    container.innerHTML = `
                        <!-- SECCI√ìN 1: CUENTO -->
                    <div style="margin-bottom: 3rem; border-bottom: 3px dashed #FFB7B2; padding-bottom: 2rem;">
                        <h2 style="text-align: center; color: #FF6B6B; font-family: var(--font-display); margin-bottom: 1.5rem;">1. Comprendo el cuento üìñ</h2>
                        
                        <div class="summary-card">
                            <h3>ü¶Ñ ¬øDe qu√© va la historia?</h3>
                            <p><strong>Mica</strong> (la protagonista) y sus amigos encuentran un objeto muy misterioso escondido en el colegio: <strong>¬°Un Reloj Universal!</strong> üï∞Ô∏è‚ú®</p>
                        </div>
                        
                        <div class="summary-card">
                            <h3>üí° Lo que aprendemos</h3>
                            <p>Con esta historia practicamos la <strong>lectura</strong> y entendemos mejor c√≥mo funciona el paso del tiempo.</p>
                        </div>
                    </div>

                    <!-- SECCI√ìN 2: LENGUA -->
                        <div>
                            <h2 style="text-align: center; color: #4ECDC4; font-family: var(--font-display); margin-bottom: 1.5rem;">2. Entiendo la lengua üó£Ô∏è</h2>

                            <div class="summary-card" style="background: #E0F7FA;">
                                <h3>üó£Ô∏è Los Pronombres Personales</h3>
                                <p>Las palabras <strong>yo, t√∫, √©l, ella...</strong> sirven para nombrar a personas sin decir su nombre.</p>
                                <div style="display: grid; grid-template-columns: 1fr; gap: 1rem; margin-top: 1rem;">
                                    <div style="background: white; padding: 15px; border-radius: 10px; border-left: 5px solid #FF6B6B;">
                                        <h4 style="margin-top:0; color: #FF6B6B;">1Ô∏è‚É£ Singular</h4>
                                        <p>üî¥ <strong>Yo</strong>, üîµ <strong>T√∫</strong>, üü¢ <strong>√âl / Ella</strong></p>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 10px; border-left: 5px solid #4ECDC4;">
                                        <h4 style="margin-top:0; color: #4ECDC4;">‚ûï Plural</h4>
                                        <p>üî¥ <strong>Nosotros/as</strong>, üîµ <strong>Vosotros/as</strong>, üü¢ <strong>Ellos/as</strong></p>
                                    </div>
                                </div>
                            </div>
                        </div>

                    <!-- SECCI√ìN 3: ESCRIBO BIEN -->
                        <div>
                            <h2 style="text-align: center; color: #FFD54F; font-family: var(--font-display); margin-bottom: 1.5rem; margin-top: 3rem;">3. Escribo bien ‚úçÔ∏è</h2>

                            <div class="summary-card" style="background: #FFF9C4;">
                                <h3>üî§ za, zo, zu, ce, ci</h3>
                                <p>El sonido <strong>Z</strong> se escribe de dos formas diferentes:</p>
                                <p><strong>Za, Zo, Zu</strong> (zapato) | <strong>Ce, Ci</strong> (cesta)</p>
                            </div>
                        </div>
                        
                    <!-- SECCI√ìN 4: PALABRAS -->
                        <div>
                            <h2 style="text-align: center; color: #81C784; font-family: var(--font-display); margin-bottom: 1.5rem; margin-top: 3rem;">4. Conozco las palabras üé≠</h2>
                             <div class="summary-card" style="background: #F1F8E9;">
                                <h3>üé≠ Palabras Polis√©micas</h3>
                                <p>¬°Son palabras m√°gicas! ‚ú® Se escriben igual pero significan cosas diferentes.</p>
                                <ul style="list-style: none; padding: 0;">
                                    <li>üçÇ <strong>Hoja:</strong> De √°rbol o de papel.</li>
                                    <li>üíå <strong>Carta:</strong> De baraja o de correo.</li>
                                    <li>üí∞ <strong>Banco:</strong> De sentarse o de dinero.</li>
                                </ul>
                            </div>
                        </div>
                    `;
                }

                function renderLenguaEjercicios(container, titleElement, subseccion, params) {
                    titleElement.textContent = "Ejercicios de Lengua ‚úçÔ∏è";
                    document.title = "Ejercicios - Lengua";
                    const asignatura = params.get('asignatura');

                    if (!subseccion) {
                        container.innerHTML = `
                            <div style="display: flex; flex-direction: column; gap: 1rem; width: 100%;">
                                <a href="contenido.html?asignatura=${asignatura}&type=ejercicios&subseccion=gramatica" class="card-btn subject" style="width: 100%; height: auto; flex-direction: row; justify-content: flex-start; padding: 1.5rem; border-radius: 15px;">
                                    <span style="font-size: 2.5rem; margin-right: 1.5rem;">üó£Ô∏è</span>
                                    <span style="font-size: 1.5rem;">Gram√°tica: Pronombres</span>
                                </a>
                                <a href="contenido.html?asignatura=${asignatura}&type=ejercicios&subseccion=ortografia" class="card-btn subject" style="width: 100%; height: auto; flex-direction: row; justify-content: flex-start; padding: 1.5rem; border-radius: 15px;">
                                    <span style="font-size: 2.5rem; margin-right: 1.5rem;">‚úçÔ∏è</span>
                                    <span style="font-size: 1.5rem;">Ortograf√≠a: za, zo, zu</span>
                                </a>
                                <a href="contenido.html?asignatura=${asignatura}&type=ejercicios&subseccion=vocabulario" class="card-btn subject" style="width: 100%; height: auto; flex-direction: row; justify-content: flex-start; padding: 1.5rem; border-radius: 15px;">
                                    <span style="font-size: 2.5rem; margin-right: 1.5rem;">üÉè</span>
                                    <span style="font-size: 1.5rem;">Vocabulario: Polis√©micas</span>
                                </a>
                            </div>
                         `;
                        return;
                    }

                    if (subseccion === 'gramatica') {
                        container.innerHTML = `
                            <div class="exercise-card">
                                <h3>üó£Ô∏è Los Pronombres Personales</h3>
                                <p>Sustituye la palabra destacada por un pronombre (Yo, T√∫, √âl, Nosotros...)</p>
                                <div class="question-block">
                                    <p>1. <strong>Juan</strong> juega al bal√≥n.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Yo</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">√âl</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">Nosotros</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>2. <strong>Ana y yo</strong> comemos helado.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Vosotras</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">Nosotras</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">Ellas</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>3. <strong>Mis amigos</strong> van al cine.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Nosotros</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">Ellos</button>
                                    </div>
                                </div>
                                <button class="check-btn" onclick="calculateScore()">Comprobar ‚úÖ</button>
                                <div id="score-result" class="score-display"></div>
                            </div>
                        `;
                    } else if (subseccion === 'ortografia') {
                        container.innerHTML = `
                             <div class="exercise-card">
                                <h3>‚úçÔ∏è za, zo, zu, ce, ci</h3>
                                <p>Elige la s√≠laba correcta.</p>
                                <div class="question-block">
                                    <p>1. Me gusta el ___mo de naranja.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, true)">zu</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">cu</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>2. Ponte el ___pato.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, true)">za</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">ca</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>3. La ___reza es roja.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">que</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">ce</button>
                                    </div>
                                </div>
                                <button class="check-btn" onclick="calculateScore()">Comprobar ‚úÖ</button>
                                <div id="score-result" class="score-display"></div>
                            </div>
                        `;
                    } else if (subseccion === 'vocabulario') {
                        container.innerHTML = `
                             <div class="exercise-card">
                                <h3>üé≠ Palabras Polis√©micas</h3>
                                <p>¬øQu√© significa la palabra destacada en cada frase?</p>
                                <div class="question-block">
                                    <p>1. He escrito una <strong>carta</strong> a mi abuela.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Naipes de juego</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">Papel con mensaje</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>2. El <strong>banco</strong> est√° lleno de peces.</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Asiento del parque</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">Grupo de peces</button>
                                    </div>
                                </div>
                                <button class="check-btn" onclick="calculateScore()">Comprobar ‚úÖ</button>
                                <div id="score-result" class="score-display"></div>
                            </div>
                        `;
                    } else {
                        container.innerHTML = `<p>Secci√≥n no encontrada.</p>`;
                    }
                }

                function renderValenciaResumenes(container, titleElement, tema) {
                    titleElement.textContent = "Resum Valenci√† ü•ò";
                    document.title = "Resum - Valenci√†";

                    container.innerHTML = `
                    <div class="summary-card" style="background: #E8F5E9; border-left-color: #4CAF50;">
                        <h3>üêæ Fitxa 4: D'animals i animalets</h3>
                        <p>Vocabulari de les fam√≠lies d'animals:</p>
                        <ul style="list-style: none; padding-left: 0;">
                            <li>üêÇ <strong>Bou</strong> (Pare) - üêÑ <strong>Vaca</strong> (Mare) - üçº <strong>Vedella</strong> (Cria)</li>
                            <li>üêé <strong>Cavall</strong> - ü¶Ñ <strong>Egua</strong> - üê¥ <strong>Poltre</strong></li>
                            <li>üêè <strong>Molt√≥</strong> - üêë <strong>Ovella</strong> - üß∂ <strong>Corder</strong></li>
                        </ul>
                        <p><strong>Noms especials de cries:</strong> Conill ‚ûù Catxap, √Äguila ‚ûù Aguil√≥.</p>
                    </div>
                    
                    <div class="summary-card" style="background: #E1F5FE; border-left-color: #2196F3;">
                        <h3>‚úçÔ∏è Fitxa 5: Els signes de puntuaci√≥</h3>
                        <p><strong>: Els dos punts</strong> ‚ûù Abans de llistar coses o despr√©s de saludar.</p>
                        <p><strong>, La coma</strong> ‚ûù Per a separar paraules en una llista.</p>
                    </div>

                    <div class="summary-card" style="background: #FFF3E0; border-left-color: #FF9800;">
                        <h3>üê¢ Fitxa 6: Aventures animals</h3>
                        <p><strong>Les faules</strong> s√≥n hist√≤ries on els animals parlen i ens ensenyen coses importants.</p>
                    </div>
                    `;
                }

                function renderValenciaEjercicios(container, titleElement, tema, subseccion, params) {
                    titleElement.textContent = "Exercicis de Valenci√† ü•ò";
                    document.title = "Exercicis - Valenci√†";
                    const asignatura = params.get('asignatura');

                    if (!subseccion) {
                        container.innerHTML = `
                            <div style="display: flex; flex-direction: column; gap: 1rem; width: 100%;">
                                <a href="contenido.html?asignatura=${asignatura}&type=ejercicios&tema=${tema}&subseccion=fitxa4" class="card-btn subject" style="width: 100%; height: auto; flex-direction: row; justify-content: flex-start; padding: 1.5rem; border-radius: 15px;">
                                    <span style="font-size: 2.5rem; margin-right: 1.5rem;">üìù</span>
                                    <span style="font-size: 1.5rem;">Fitxa 4: D'animals</span>
                                </a>
                                <a href="contenido.html?asignatura=${asignatura}&type=ejercicios&tema=${tema}&subseccion=fitxa5" class="card-btn subject" style="width: 100%; height: auto; flex-direction: row; justify-content: flex-start; padding: 1.5rem; border-radius: 15px;">
                                    <span style="font-size: 2.5rem; margin-right: 1.5rem;">üÉè</span>
                                    <span style="font-size: 1.5rem;">Fitxa 5: Puntuaci√≥</span>
                                </a>
                                <a href="contenido.html?asignatura=${asignatura}&type=ejercicios&tema=${tema}&subseccion=fitxa6" class="card-btn subject" style="width: 100%; height: auto; flex-direction: row; justify-content: flex-start; padding: 1.5rem; border-radius: 15px;">
                                    <span style="font-size: 2.5rem; margin-right: 1.5rem;">üìñ</span>
                                    <span style="font-size: 1.5rem;">Fitxa 6: Lectura / Faules</span>
                                </a>
                            </div>
                         `;
                        return;
                    }

                    if (subseccion === 'fitxa4') {
                        container.innerHTML = `
                            <div class="exercise-card">
                                <h3>Fitxa 4: Parelles d'animals</h3>
                                <p>Qui va amb qui?</p>
                                <div class="question-block">
                                    <p>1. üêê <strong>Cabra</strong> va amb...</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Conill</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">Cabrit</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>2. üê∏ <strong>Granota</strong> va amb...</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, true)">Cullerot</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">Catxap</button>
                                    </div>
                                </div>
                                <button class="check-btn" onclick="calculateScore()">Comprovar ‚úÖ</button>
                                <div id="score-result" class="score-display"></div>
                            </div>
                         `;
                    } else if (subseccion === 'fitxa5') {
                        container.innerHTML = `
                            <div class="exercise-card">
                                <h3>Fitxa 5: Signes de puntuaci√≥</h3>
                                <p>Tria : o ,</p>
                                <div class="question-block">
                                    <p>1. "M'agraden molt els animals<strong>___</strong> dofins, gossos i gats."</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, true)">Dos punts (:)</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">Coma (,)</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>2. "Dofins<strong>___</strong> gossos i gats."</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, false)">Dos punts (:)</button>
                                        <button class="btn-option" onclick="selectOption(this, true)">Coma (,)</button>
                                    </div>
                                </div>
                                <button class="check-btn" onclick="calculateScore()">Comprovar ‚úÖ</button>
                                <div id="score-result" class="score-display"></div>
                            </div>
                        `;
                    } else if (subseccion === 'fitxa6') {
                        container.innerHTML = `
                            <div class="exercise-card">
                                <h3>Fitxa 6: La llebre i la tortuga</h3>
                                <p>Qu√® va passar primer?</p>
                                <div class="question-block">
                                    <p>1. Al principi de la hist√≤ria...</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, true)">La llebre es reia de la tortuga</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">La tortuga va guanyar</button>
                                    </div>
                                </div>
                                <div class="question-block">
                                    <p>2. Per qu√® va guanyar la tortuga?</p>
                                    <div class="options-container">
                                        <button class="btn-option" onclick="selectOption(this, true)">Perqu√® la llebre es va adormir</button>
                                        <button class="btn-option" onclick="selectOption(this, false)">Perqu√® la tortuga corria molt</button>
                                    </div>
                                </div>
                                <button class="check-btn" onclick="calculateScore()">Comprovar ‚úÖ</button>
                                <div id="score-result" class="score-display"></div>
                            </div>
                         `;
                    } else {
                        container.innerHTML = `<p>Fitxa no trobada.</p>`;
                    }
                }

                // Math Logic Injection (Restoring missing logic if it was inline)
                function initMathLogic() {
                    const grid = document.getElementById('math-grid');
                    if (grid) {
                        grid.innerHTML = ''; // Clean
                        for (let i = 0; i < 20; i++) {
                            const isAddition = Math.random() > 0.5;
                            const num1 = Math.floor(Math.random() * 90) + 10;
                            const num2 = Math.floor(Math.random() * 90) + 10;

                            // Ensure 2-digit result for subtraction to be positive, and carrying/borrowing if desired
                            // Simple logic:
                            let op = isAddition ? '+' : '-';
                            let val1 = num1;
                            let val2 = num2;
                            if (!isAddition && val2 > val1) { [val1, val2] = [val2, val1]; } // Swap for positive result

                            const div = document.createElement('div');
                            div.className = 'exercise-card';
                            div.style.textAlign = 'center';
                            div.innerHTML = `
                                <div style="font-size: 2rem; font-family: monospace; letter-spacing: 5px;">
                                    ${val1}<br>${op}${val2}<br><hr>
                                </div>
                                <input type="number" class="math-input" data-correct="${isAddition ? val1 + val2 : val1 - val2}" style="
                                    font-size: 1.5rem; width: 80px; text-align: center; border: 2px solid #ccc; border-radius: 10px; padding: 5px;
                                ">
                            `;
                            grid.appendChild(div);
                        }
                    }
                }

                window.checkMathBatch = function () {
                    const inputs = document.querySelectorAll('.math-input');
                    let correct = 0;
                    inputs.forEach(input => {
                        const val = parseInt(input.value);
                        const expected = parseInt(input.dataset.correct);
                        if (val === expected) {
                            input.style.backgroundColor = '#d4edda';
                            input.style.borderColor = '#28a745';
                            correct++;
                        } else {
                            input.style.backgroundColor = '#f8d7da';
                            input.style.borderColor = '#dc3545';
                        }
                    });
                    document.getElementById('final-score').textContent = `Puntuaci√≥n: ${correct} / 20`;
                    if (correct === 20) {
                        document.getElementById('final-score').textContent += " ¬°INCRE√çBLE! üèÜ";
                        const audio = new Audio('https://actions.google.com/sounds/v1/cartoon/clown_horn.ogg'); // Example sound or none
                    }
                };

            } catch (error) {
                alert("Error cr√≠tico en el script: " + error.message + "\n\n" + error.stack);
                console.error(error);
                document.getElementById('content-area').innerHTML = `<h1>üí• Error Critico</h1><p>${error.message}</p>`;
            }

            updateClock();
            setInterval(updateClock, 1000);
        });

        // L√≥gica de Selecci√≥n (sin mostrar resultado inmediato)
        function selectOption(btn, isCorrect) {
            // Reset siblings
            const parent = btn.parentElement;
            const siblings = parent.querySelectorAll('.btn-option');
            siblings.forEach(sib => {
                sib.classList.remove('selected');
                sib.style.background = 'white';
                sib.style.color = 'var(--color-texto)';
            });

            // Mark selected
            btn.classList.add('selected');
            btn.style.background = '#C7CEEA'; // Color selecci√≥n

            // Store correctness data tag
            btn.dataset.correct = isCorrect;
        }

        function calculateScore() {
            const selectedOptions = document.querySelectorAll('.btn-option.selected');
            let correctCount = 0;

            selectedOptions.forEach(btn => {
                if (btn.dataset.correct === 'true') {
                    btn.style.background = '#d4edda';
                    btn.style.borderColor = '#28a745';
                    correctCount++;
                } else {
                    btn.style.background = '#f8d7da';
                    btn.style.borderColor = '#dc3545';
                }
            });

            // Mostrar resultado
            const resultDiv = document.getElementById('score-result');
            resultDiv.style.display = 'block';

            if (correctCount > 0) {
                resultDiv.textContent = `¬°Has acertado ${correctCount} preguntas! üéâ`;
            } else {
                resultDiv.textContent = `¬°Sigue intent√°ndolo! T√∫ puedes üí™`;
            }

            window.scrollTo(0, document.body.scrollHeight);
        }
    </script>
</body>

</html>